<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/style.css">
    

    <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Atom feed">

    
      <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2"/>
    

    
    <title>Charles Petzold教你造一台计算机</title>
</head>

<body>

<pre><code>小白读《编码：隐匿在计算机软硬件背后的语言》
</code></pre><h2 id="0000-为什么开始读此书"><a href="#0000-为什么开始读此书" class="headerlink" title="0000 为什么开始读此书"></a>0000 为什么开始读此书</h2><p>“什么，你一点硬件不懂就敢写软件啊？居然还写系统软件，真牛逼！”<br>同事的这句话应该不是对我的褒奖吧？好吧，我承认我很惭愧。</p>
<p>刚迈入实验室的时候，我是一心想做编译器后端开发的，这也是老板招我进实验室的初衷。编译器是针对特定的处理器而存在的，恰巧，我们实验室就有这么一款需要搭配编译器的特定的处理器。当然，你不能单纯地只去做编译器，你得利用GNU的汇编器、链接器、C库吧？如果你还想在没有芯片的情况下做上层的应用开发，你可能还要推出一款仿真器。好吧，全套的工具链已经出来了。这不是问题的关键，因为你需要支持处理器的指令集，你就要非常熟悉它的体系结构，如果你想在它上面运行Linux，恭喜你，你至少得移植个Bootloader，移植个文件系统和基本的系统应用，当然移植内核才是最重要的，这你就要明白内核模块的构建（Oh my Makefile），内核配置、如何让它支持你的硬件。哇喔，你得了解你得处理器和与它相连的N个外设，硬件手册都搞到了（老天怜悯，硬件工程师能给你一套靠谱的说明文档）。好了，你可以开始写驱动程序，这是另一个故事了。</p>
<p>想做一名系统软件工程师或者嵌入式工程师这么难么？他需要接触的系统软件包括但不局限于：工具链，操作系统（包括内核、驱动、图形界面……），不说了，全是泪，我来实验室快三年了，还没入门，上面所有的东西我都搞过，但是都没搞懂。</p>
<p>我意识到，原来我从来没学过什么硬件呀，软件也只上了三年学，搞毛啊，能不能让我从最基础的学起，让我知道计算机时什么东西好么？终于，故事的主人公不经意见站到了我面前。《编码：隐匿在计算机软硬件背后的语言》电子工业出版社（原著《Code：The Hidden Language of Computer Hardware and Software》）。</p>
<p>“所谓经典，就是历尽岁月的洗涤，依然毫不褪色，然其光彩却历久弥新。”</p>
<p>本书的作者确实是一位技术＋写作的大师，他把计算机的本质，计算机的软硬件协同理解到了骨髓。最难能可贵的是，他能用如此生动的语言和比喻向各个层次的读者描述这个看似枯燥的计算机组成原理。拜读其神作后，相信大多数像我一样的迷茫少年都会有种相见恨晚的感觉。为了让我这个有着鱼记忆的人能够记住并理解好书的精髓，刚读完本书的最后一个标点符号，就有种想提笔回忆一下，我究竟看到了些什么，他为什么让我如此欣赏和喜爱。</p>
<h2 id="0001-书里说了啥"><a href="#0001-书里说了啥" class="headerlink" title="0001 书里说了啥"></a>0001 书里说了啥</h2><p>看书名就知道全书的核心问题是“编码”：二进制码、ASCII码、指令编码……</p>
<p>书的最开始是从手电筒的长短闪烁引入的，当然在作者笔下这是个很好玩的故事。当你知道手电筒的长闪烁和短闪烁这两种状态可以传递信息时，你就已经有足够的知识储备读完本书了。26个英文字母、数字、标点，这些都可用手电筒的长短闪烁组合的方式表示出来，如果现在给你一张对照表的话，恭喜你，你就懂了著名的莫尔斯电码，这显然是一种有用的编码。</p>
<p>布莱叶盲文是用凹凸的两个圆点组合得到的一种编码方式，或许你已经发现他和莫尔斯电码的共同点，这两种编码都是只有两种元素组成，我们姑且称这两个元素为0和1。</p>
<p>随后Petzold开始了有趣的物理课程（初中物理）。我们知道计算机是靠电力驱动的，所有的计算功能都离不开电能。我们把之前的手电筒简化成只有导线、开关、灯泡组成的电路。开关闭合则灯泡发光，开关断开，则灯泡熄灭：呀呼，只有这两种状态，展现出了最简洁的美，我们有了不错的开始。以此为开端，加上基本的元件（铁芯、线圈、金属片等），我们将一步步组成越来越复杂的电子元器件，最终组装成一台电子计算机。</p>
<ul>
<li>第一步，先来看如何用开关、导线、灯泡电路来进行通信。这其实在第一张手电筒的故事里已经描述过了：通信的两端实现约定好灯泡亮灭组合所代表的含义（当然最直接的方法就是把莫尔斯密码拿来用）。一次通信的过程中，发送的一端把要表达的信息编码成开关电源的组合（如闭合、断开、闭合……），相应的信息接收的一端会看到灯泡的亮灭交替并记录下这些信息，然后对照约定的编码表，还原出编码本身的含义。</li>
<li>第二步，应用一下我们的通信方案，实际上我们造出了一台电报机！为了在远距离传输中克服导线电阻，我们引入继电器这一意义非凡的器件，实际上就是电磁铁和金属片的组合。有了它，电报中转站就能实现电流放大的自动化操作。（这部分Petzold讲得非常有画面感，很有意思）。当然，继电器在后续搭建计算机的过程中将发挥更重要的作用。</li>
<li>第三步，理解更复杂一些的二进制逻辑。数学是自然科学的基础，为了能够组合出完成更复杂功能的计算部件，我们需要用清晰的数学语言来指导。好在19世纪中叶，伟大的数学件布尔创建了布尔代数，为我们需要的逻辑定义好了表示法和运算法则，依此我们就能够处理不同几何的逻辑运算问题。但当时并没有人把布尔表达式和电路等价起来。到了20世纪30年代，信息论创始人香农为这一切铺好了道路：他用若干继电器和开关组成逻辑门，实现了布尔表达式的与或非等操作。这里使用继电器的好处是它可以作为一个电流控制而非人工控制的开关。至此，如果我们想实现具有特定的功能的逻辑电路，我们可以写出其布尔表达式，并进行化简计算，最终将计算结果实现在我们的电路上。</li>
<li>第四步，实现加法器。我们用一个“异或门”和一个“与门”就可以组成二进制的半加器，原理并不复杂，再加上进位的话就组成全家器，8个全家器连接起来就组成了一个完整的8位串行的二进制加法器。看，最原始的数字加法器就是这么来的，好神奇！</li>
<li>第五步，实现减法器。你或许和我曾经有一样的疑惑：为什么计算机内部要用补码表示负数？当计算1110_0111-1011_0000时，和加法的进位一样，减法的借位也是一件很麻烦的事情，为了少算借位，我们先给它加上一个减去减数时不需要借位的数，这就是1111_1111，原式变为1110_0111+(1111_1111-1011_0000)+1-1_0000_000，我们用1_0000_000的最高位的那个1表示符号位，如果1110_0111+(1111_1111-1011_0000)+1有进位，那结果的符号位就为0，否则就为1（表示负数）。</li>
<li></li>
</ul>
<h2 id="0010-标注及勘误"><a href="#0010-标注及勘误" class="headerlink" title="0010 标注及勘误"></a>0010 标注及勘误</h2><p>总体来说本书翻译得还是很不错的，书本制作也算精良，下面我把自己在读的时候遇到一些晦涩或个人认为有问题的地方标注出来，希望给和我有同样困惑的读者一个参考。</p>
<ul>
<li>P206 倒数第6行，“相比于其他的顺序型的存储器，这种存储器在使用时有一定限制，如果想要读区地址为101的数据，必须先把地址为100的数据读取出来”。这里翻译的我认为有一些问题，这句话实际上说的是顺序型存储器，而非上文所探讨的随机访问存储器。可直接翻译为“而对于其他的顺序型的存储器，在使用时有一定限制……”。磁带就是典型的顺序型存储器，见P291。</li>
<li>P218 文字的第5行，“然后闭合RAM控制面板的控制开关”。我认为这里应该是“断开RAM控制面板的开关”。</li>
<li>P286 “累加器中的值变为22h”，应为13h。</li>
<li>P295 第4行，“LXI指令保存一个字节”，LXI应该是保存了两个字节。</li>
<li>P315 有一行代码是“CPI A，78h”，这里比较累加器A的值和字符‘z’，字符‘z’的ASCII码是7Bh，而非78h。</li>
<li>P317 最后一行，“换页符（12h）”，换页符的ASCII码应为0Ch。</li>
</ul>


<!--<a href="http://yoursite.com/2016/03/23/charles_petzold教你造一台计算机/#disqus_thread" class="article-comment-link">Comments</a>-->
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = ''; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

<div style="display:none">
<script src="http://s4.cnzz.com/stat.php?id=&web_id=" language="JavaScript"></script>script>
</div>







</body>
</html>